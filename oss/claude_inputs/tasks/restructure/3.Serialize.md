ğŸ¯ ä»»å‹™ï¼šæ§‹é€ éå¯†é ˜åŸŸã«ãŠã‘ã‚‹Serializationæ©Ÿèƒ½ã®åˆ†é›¢ï¼ˆPhase 2ï¼‰

ğŸ§  èƒŒæ™¯ï¼š
Avroé–¢é€£ã®ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¶ãƒ¼ã‚„ã‚­ãƒ£ãƒƒã‚·ãƒ¥å‡¦ç†ãŒå·¨å¤§ãªã‚¯ãƒ©ã‚¹ã«é›†ä¸­ã—ã¦ãŠã‚Šã€  
ç›£è¦–ãƒ»å›å¾©æ€§å‡¦ç†ã¨ã‚‚æ··åœ¨ã—ã¦ã„ã‚‹ã“ã¨ã§ã€ä¿å®ˆæ€§ãƒ»ãƒ†ã‚¹ãƒˆæ€§ãŒè‘—ã—ãä½ä¸‹ã—ã¦ã„ã‚‹ã€‚  
ã“ã‚Œã‚’è²¬å‹™ã”ã¨ã«åˆ†é›¢ã—ã€å†åˆ©ç”¨å¯èƒ½ãªæ§‹é€ ã¨ã™ã‚‹ã€‚

---

ğŸ“¦ å¯¾è±¡æ§‹é€ ï¼ˆç¾çŠ¶ï¼‰ï¼š

- `AvroSerializerCache.cs`ï¼ˆç´„400è¡Œï¼‰
  - ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¶ç”Ÿæˆã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥åˆ¶å¾¡ã€è¨­å®šä¾å­˜ã€è¨ºæ–­ãƒ­ã‚°

- `AvroSchemaVersionManager.cs`
  - ãƒãƒ¼ã‚¸ãƒ§ãƒ³åˆ‡ã‚Šæ›¿ãˆã€ã‚¹ã‚­ãƒ¼ãƒIDå–å¾—

- `AvroUtils.cs`
  - ã‚¹ã‚­ãƒ¼ãƒç”Ÿæˆï¼å±æ€§æŠ½å‡ºãƒ­ã‚¸ãƒƒã‚¯

---

ğŸ§© ä½œæ¥­å†…å®¹ï¼š

âœ… 1. æ–°æ§‹é€ é…ç½®

src/Serialization/
â”œâ”€â”€ Avro/
â”‚ â”œâ”€â”€ Core/
â”‚ â”‚ â””â”€â”€ AvroSerializerFactory.cs // Tå‹ã«å¯¾ã™ã‚‹ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¶ãƒ¼ç”Ÿæˆ
â”‚ â”œâ”€â”€ Cache/
â”‚ â”‚ â””â”€â”€ AvroSerializerCache.cs // ã‚¹ã‚­ãƒ¼ãƒIDã¨å‹ã”ã¨ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç†
â”‚ â”œâ”€â”€ Management/
â”‚ â”‚ â”œâ”€â”€ AvroSchemaVersionManager.cs // ã‚¹ã‚­ãƒ¼ãƒé€²åŒ–ï¼åˆ‡æ›¿ãƒ­ã‚¸ãƒƒã‚¯
â”‚ â”‚ â””â”€â”€ AvroSchemaBuilder.cs // Avroã‚¹ã‚­ãƒ¼ãƒæ§‹ç¯‰ï¼ˆlogicalTypeå«ã‚€ï¼‰
â”‚ â””â”€â”€ Internal/
â”‚ â””â”€â”€ AvroUtils.cs // å±æ€§æŠ½å‡ºã€å¤‰æ›ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”œâ”€â”€ Abstractions/
â”‚ â”œâ”€â”€ ISerializationManager<T>.cs
â”‚ â”œâ”€â”€ IAvroSchemaProvider.cs
â”‚ â””â”€â”€ ISchemaVersionResolver.cs

âœ… 2. æ©Ÿèƒ½åˆ†é›¢ã®è©³ç´°

- `AvroSerializerCache` â†’ `Cache/` ã¸ç§»å‹•ã—ã€**`ISerializationManager<T>`** ã«å¾“ã£ã¦è²¬å‹™åˆ†é›¢
- `AvroSchemaVersionManager` â†’ `Management/` ã¸ç§»å‹•ã—ã€**`ISchemaVersionResolver`** ã‚’æ˜ç¤º
- `AvroUtils.cs` â†’ å¿…è¦ãªå‡¦ç†ã ã‘ã‚’ `AvroSchemaBuilder.cs` ã¾ãŸã¯ `AvroSchemaMapper.cs` ã«ç§»è¡Œã—ã€**éå…¬é–‹ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã«é™å®š**
- æ§‹é€ åŒ–ã•ã‚ŒãŸã‚¹ã‚­ãƒ¼ãƒæ§‹ç¯‰ã¨è«–ç†å‹ï¼ˆ`decimal`, `DateTime`ï¼‰å¯¾å¿œã¯ `AvroSchemaBuilder` ã«çµ±ä¸€

---

ğŸ“˜ è¨­è¨ˆã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ï¼š

- åå‰ç©ºé–“ï¼š`KsqlDsl.Serialization.Avro.Xxx`
- `Avro/` ã¯JSONã‚„ãã®ä»–å½¢å¼ã¨ã®æ‹¡å¼µæ€§ã‚’ä¿ã¤å‰æã§åˆ†ã‘ã‚‹ã“ã¨
- ä¾å­˜é–¢ä¿‚ã¯ `Core` â†’ `Cache` â†’ `Management` â†’ `Internal` ã®é †ã«ä¸‹æµã¨ã™ã‚‹

---

ğŸ§ª ãƒ†ã‚¹ãƒˆå¯¾å¿œï¼ˆè©©éŸ³ã¨é€£æºï¼‰ï¼š

- `AvroSerializerCacheTests`, `AvroSchemaVersionManagerTests` ãªã©ã‚’ `tests/Serialization/Avro/` ä»¥ä¸‹ã«ç§»å‹•
- round-tripãƒ†ã‚¹ãƒˆï¼ˆSerializeâ†’Deserializeâ†’Equalï¼‰ã‚’ `ISerializationManager<T>` çµŒç”±ã§å†å®šç¾©
- schema IDãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œãƒ†ã‚¹ãƒˆã‚‚æ˜ç¤º

---

ğŸ“„ æ–‡æ›¸å‡ºåŠ›ï¼ˆå¿…è¦æ™‚ï¼‰ï¼š

- `docs/Serialization/responsibilities.md`
- `docs/Serialization/interfaces.md`
- `docs/Serialization/design_guidelines.md`

---

âš ï¸ æ³¨æ„ï¼š

- `Monitoring/Health/AvroHealthChecker.cs` ã‹ã‚‰ `AvroSerializerCache` ã‚’å‚ç…§ã™ã‚‹å ´åˆã¯ã€æ˜ç¤ºçš„ã«`using`ã—ã€ä¾å­˜æ–¹å‘ã‚’é€†è»¢ã•ã›ãªã„ã“ã¨
- å°†æ¥çš„ãª `JsonSerializerManager<T>` ã«å‚™ãˆã€æŠ½è±¡å±¤ï¼ˆ`ISerializationManager<T>`ï¼‰ã¯Avroä¾å­˜ã‚’æŒãŸã›ãªã„

