ğŸ¯ ä»»å‹™ï¼šKafkaé€šä¿¡å±¤ã®æ©Ÿèƒ½åˆ†é›¢ã¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å†æ§‹æˆï¼ˆPhase 3ï¼‰

ğŸ§  èƒŒæ™¯ï¼š
Communicationåå‰ç©ºé–“ï¼ˆ19ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã«Producerãƒ»Consumerãƒ»ãƒã‚¹çµ±åˆãƒ»ãƒ˜ãƒ«ã‚¹ç›£è¦–ãƒ»è¨­å®šãŒæ··åœ¨ã—ã€  
æ§‹é€ çš„è¤‡é›‘æ€§ã¨è²¬å‹™ä¸æ˜ç­æ€§ãŒé«˜ã„ã€‚ã“ã‚Œã‚’Messagingå°‚ç”¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¸æ©Ÿèƒ½åˆ¥ã«åˆ†é›¢ã—ã€  
å†åˆ©ç”¨æ€§ãƒ»ãƒ†ã‚¹ã‚¿ãƒ“ãƒªãƒ†ã‚£ãƒ»ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã‚’é£›èºçš„ã«å‘ä¸Šã•ã›ã‚‹ã€‚

---

ğŸ“¦ å¯¾è±¡æ§‹é€ ï¼ˆç¾çŠ¶ï¼‰ï¼š

- `KafkaProducerPool.cs` / `KafkaConsumerPool.cs`
  - ãƒ—ãƒ¼ãƒ«æ©Ÿèƒ½ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å…±æœ‰

- `KafkaProducer.cs` / `KafkaConsumer.cs`
  - Publish / Subscribeæ©Ÿèƒ½æœ¬ä½“

- `KafkaMessageBus.cs`
  - Producer / Consumerã®çµ±åˆç®¡ç†

- `KafkaMessageBusOptions.cs`
  - å„æ©Ÿèƒ½è¨­å®šï¼ˆç›£è¦–å«ã‚€ã€800è¡Œï¼‰

- `KafkaMetricsLogger.cs`ï¼ˆãƒã‚¹å†…è¨ºæ–­ï¼‰

---

ğŸ§© ä½œæ¥­å†…å®¹ï¼š

âœ… 1. æ–°æ§‹é€ é…ç½®

src/Messaging/
â”œâ”€â”€ Producers/
â”‚ â”œâ”€â”€ Core/
â”‚ â”‚ â””â”€â”€ KafkaProducer.cs
â”‚ â”œâ”€â”€ Pool/
â”‚ â”‚ â””â”€â”€ ProducerPoolManager.cs
â”‚ â””â”€â”€ Health/
â”‚ â””â”€â”€ ProducerHealthChecker.cs
â”œâ”€â”€ Consumers/
â”‚ â”œâ”€â”€ Core/
â”‚ â”‚ â””â”€â”€ KafkaConsumer.cs
â”‚ â”œâ”€â”€ Pool/
â”‚ â”‚ â””â”€â”€ ConsumerPoolManager.cs
â”‚ â””â”€â”€ Subscription/
â”‚ â””â”€â”€ SubscriptionManager.cs
â”œâ”€â”€ Bus/
â”‚ â”œâ”€â”€ KafkaMessageBus.cs
â”‚ â””â”€â”€ BusDiagnostics.cs
â”œâ”€â”€ Abstractions/
â”‚ â”œâ”€â”€ IKafkaProducer<T>.cs
â”‚ â”œâ”€â”€ IKafkaConsumer<T>.cs
â”‚ â”œâ”€â”€ ISubscriptionManager<T>.cs
â”‚ â””â”€â”€ IMessageBusCoordinator.cs

âœ… 2. åˆ†é›¢ã®å…·ä½“å†…å®¹

- **Producerç³»**
  - `KafkaProducer.cs` â†’ `Producers/Core/` ã¸
  - `KafkaProducerPool.cs` â†’ `Producers/Pool/` ã«çµ±åˆã— `IPoolManager<TKey, T>` æº–æ‹ 

- **Consumerç³»**
  - `KafkaConsumer.cs` â†’ `Consumers/Core/` ã¸
  - `KafkaConsumerPool.cs` â†’ `Consumers/Pool/` ã¸
  - è³¼èª­åˆ¶å¾¡ãƒ­ã‚¸ãƒƒã‚¯ â†’ `Subscription/SubscriptionManager.cs` ã¨ã—ã¦ç‹¬ç«‹

- **çµ±åˆãƒã‚¹**
  - `KafkaMessageBus.cs` â†’ `Bus/` ã¸
  - `BusDiagnostics.cs` ã‚’æ–°è¨­ã—ã€ç›£è¦–/çµ±è¨ˆã®åˆ†é›¢
  - `KafkaMessageBusOptions.cs` ã®è¨­å®šç³»ã¯åˆ¥é€” `Configuration/` ã«ç§»å‹•ï¼ˆPhase 4ï¼‰

---

ğŸ“˜ è¨­è¨ˆã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ï¼š

- åå‰ç©ºé–“ã¯ `KsqlDsl.Messaging.Xxx`
- **Producer** / **Consumer** ã¯ãã‚Œãã‚Œå˜ä½“ã§ã‚‚åˆ©ç”¨å¯èƒ½ã¨ã™ã‚‹ã“ã¨
- `KafkaMessageBus` ã¯ **IMessageBusCoordinator** ã®å®Ÿè£…ã¨ã—ã€Producer/Consumerã®æ³¨å…¥æ§‹æˆã‚’ã¨ã‚‹

---

ğŸ§ª ãƒ†ã‚¹ãƒˆï¼š

- å„Producer/Consumer/Busã«å¯¾ã™ã‚‹ãƒ†ã‚¹ãƒˆã¯ `tests/Messaging/` ä»¥ä¸‹ã«å†é…ç½®
- Poolç³»ã®ãƒ†ã‚¹ãƒˆã¯ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥å‹•ä½œãƒ»åˆ‡æ–­å¾©æ—§ãƒ»ä¾‹å¤–å†é€ãªã©ã‚’ç¶²ç¾…
- Busç³»ã®çµ±åˆãƒ†ã‚¹ãƒˆã§ã¯ã€`IMessagingScenario.cs` ã«ã‚ˆã‚‹ã‚·ãƒŠãƒªã‚ªé§†å‹•å‹ã§æ•´å‚™å¯èƒ½ï¼ˆå¿…è¦ã«å¿œã˜ã¦è¿½åŠ æŒ‡ç¤ºï¼‰

---

ğŸ“„ æ–‡æ›¸å‡ºåŠ›ï¼ˆå¿…è¦æ™‚ï¼‰ï¼š

- `docs/Messaging/responsibilities.md`
- `docs/Messaging/interfaces.md`
- `docs/Messaging/design_guidelines.md`

---

âš ï¸ æ³¨æ„ï¼š

- `KafkaMessageBusOptions.cs` ã®è¨­å®šç§»å‹•ã¯æ¬¡ãƒ•ã‚§ãƒ¼ã‚ºï¼ˆPhase 4ï¼‰ã§è¡Œã†
- ç›£è¦–ãƒ­ã‚¸ãƒƒã‚¯ã¯ã™ã§ã« `Monitoring/` ã«ç§»å‹•æ¸ˆã¿ã®ã‚‚ã®ã¨çµ±åˆã•ã‚Œã‚‹ã“ã¨ã‚’æƒ³å®šã—ã¦æ§‹æˆã™ã‚‹ã“ã¨
- `IKafkaProducer<T>` ãªã©ã¯ `Abstractions/` ã«çµ±ä¸€ã—ã¦ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨ã—ã¦å…¬é–‹

